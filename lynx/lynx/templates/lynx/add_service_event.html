{% extends 'lynx/base.html' %}
{% load crispy_forms_tags %}

{% block title %}Add SIP Service Event{% endblock %}

{% block javascript %}
<script>

    function addContactRoleRow() {
        const formIdx = document.getElementById('id_form-TOTAL_FORMS').value;
        const newFormHtml = document.getElementById('empty-form').innerHTML.replace(/__prefix__/g, formIdx);
        const newFormElement = document.createElement('div');
        newFormElement.innerHTML = newFormHtml;
        document.getElementById('formset').appendChild(newFormElement);
        document.getElementById('id_form-TOTAL_FORMS').value = parseInt(formIdx) + 1;
    }

</script>
{% endblock %}

{% block content %}
<!-- This will probably need to be done with ILP as well -->
<h1>Add SIP Service Event (or SIP Note)</h1>
<form method="post"> {% csrf_token %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">{{ form.service_delivery_type|as_crispy_field }}</div>
            <div class="col-12">{{ form.date|as_crispy_field }}</div>
            <div class="col-12">{{ form.length|as_crispy_field }}</div>
            <div class="col-12">{{ form.note|as_crispy_field }}</div>
            <div class="col-12">{{ form.entered_by|as_crispy_field }}</div>
        </div>
        <!--
        <div id="formset" class="row">
            {% for form in formset %}
                <div class="col-6">{{ form.contact|as_crispy_field }}</div>
                <div class="col-6">{{ form.role|as_crispy_field }}</div>
                <div class="col-6">{{ form.user|as_crispy_field }}</div>
            {% endfor %}
        </div>
        <button type="button" onclick="addContactRoleRow()">Add Contact & Role</button>
        {{ formset.management_form }}
        <div id="empty-form" style="display: none;">
            <div class="col-6">{{ formset.empty_form.contact|as_crispy_field }}</div>
            <div class="col-6">{{ formset.empty_form.role|as_crispy_field }}</div>
            <div class="col-6">{{ formset.empty_form.user|as_crispy_field }}</div>
        </div>
        <div class="row">
            {{ form.errors }}
        </div>
    </div>
    -->
    <h3>Clients</h3>
    <div id="Clients">
        <button type="button" onclick="addSectionRow('{{ role.id }}')">
            Add another {{ role.name }}
        </button>
    </div>
    <button type="submit">Save</button>
</form>
{% endblock %}
